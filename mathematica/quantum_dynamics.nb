(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15061,        390]
NotebookOptionsPosition[     13050,        347]
NotebookOutlinePosition[     13442,        363]
CellTagsIndexPosition[     13399,        360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.91395299400795*^9, 3.913953006287075*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b7a31ac3-dfcd-4a3c-a585-ea3acb046ac5"],

Cell[CellGroupData[{

Cell["Define Variables", "Subsection",
 CellChangeTimes->{{3.913963340858841*^9, 
  3.9139633450025797`*^9}},ExpressionUUID->"29dc15db-f790-4c39-af0d-\
7794c4c676cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", "1"}], ";", 
  RowBox[{"k", "=", "1"}], ";", 
  RowBox[{"range", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], ";", 
  RowBox[{"states", "=", "3"}], ";", 
  RowBox[{"time", "=", "20"}], ";"}]], "Input",
 CellChangeTimes->{{3.9139531104774942`*^9, 3.913953111004017*^9}, {
   3.913963207248796*^9, 3.9139632494092407`*^9}, 3.913963403979412*^9, {
   3.913963791848859*^9, 3.9139637989680653`*^9}, {3.913963955258601*^9, 
   3.913963956345915*^9}, {3.913963997954255*^9, 3.913964015554905*^9}, {
   3.9139647226994753`*^9, 3.913964724874074*^9}, {3.913964883403833*^9, 
   3.9139648877473516`*^9}, {3.913965121805079*^9, 3.913965123012344*^9}, {
   3.913965480024156*^9, 3.9139654929361677`*^9}, {3.9139662419651117`*^9, 
   3.913966248469116*^9}, {3.9140356102520227`*^9, 3.914035610467245*^9}, {
   3.914035734141796*^9, 3.914035740780407*^9}, {3.914040568468945*^9, 
   3.914040584564705*^9}, {3.914059297141532*^9, 3.914059299989015*^9}, {
   3.914486564896391*^9, 3.9144865653196*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"cad3968a-2de2-40d2-a19d-f98f6857fb46"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic and Potential Energy Operator", "Subsection",
 CellChangeTimes->{{3.913963369082705*^9, 3.91396338081914*^9}, {
  3.9139636107824287`*^9, 
  3.913963612814258*^9}},ExpressionUUID->"ef7b5dcf-5e4a-43b6-aae7-\
fe2a6a6cbd1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Laplacian", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "m"}], ")"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"0.5", "*", "k", "*", 
    RowBox[{"x", "^", "2"}], "#"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9139526783261013`*^9, 3.913952725493101*^9}, {
   3.913952769622748*^9, 3.913952769950755*^9}, {3.913952808070182*^9, 
   3.913952986678198*^9}, {3.9139618539828463`*^9, 3.913961857718287*^9}, {
   3.913962504131489*^9, 3.913962532651659*^9}, {3.9139630233589478`*^9, 
   3.913963024598489*^9}, {3.913963126695393*^9, 3.913963129439877*^9}, {
   3.913963407531044*^9, 3.913963408612174*^9}, 3.9139647290742807`*^9, {
   3.913964839667099*^9, 3.9139648546511374`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"6eef68dd-c07c-45fc-aa9d-9dca8496f116"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", "x", "]"}], "[", "#", "]"}], "+", 
    RowBox[{
     RowBox[{"V", "[", "x", "]"}], "[", "#", "]"}]}], "&"}]}]], "Input",
 CellChangeTimes->{{3.914034922850788*^9, 3.914034942138418*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"89b05b43-ad18-498c-9e77-d000ce9c095f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve the Time Independent Schr\[ODoubleDot]dinger Equation", \
"Subsection",
 CellChangeTimes->{{3.9139635634062*^9, 3.913963588013867*^9}, 
   3.91396561481599*^9},ExpressionUUID->"cb3d4d57-a52a-4465-9fe7-\
3baaea4fe5df"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"eigv", ",", "eigf"}], "}"}], "=", 
   RowBox[{"NDEigensystem", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"H", "[", "x", "]"}], "[", 
        RowBox[{"\[Psi]", "[", "x", "]"}], "]"}], ",", 
       RowBox[{"DirichletCondition", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]", "[", "x", "]"}], "==", "0"}], ",", "True"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"\[Psi]", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"range", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"range", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "states", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Method", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<SpatialDiscretization\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<FiniteElement\>\"", ",", 
          RowBox[{"\"\<MeshOptions\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<MaxCellMeasure\>\"", "->", "0.001"}], "}"}]}]}], 
         "}"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913962861840074*^9, 3.913962886588995*^9}, {
   3.913963161448923*^9, 3.913963186680461*^9}, {3.913963304971089*^9, 
   3.913963307082037*^9}, {3.913963423404735*^9, 3.913963434229597*^9}, {
   3.913963654479471*^9, 3.913963739103271*^9}, {3.91396380376898*^9, 
   3.913963823721608*^9}, {3.913964021347393*^9, 3.913964029475376*^9}, {
   3.9139640595565033`*^9, 3.9139640735876207`*^9}, {3.913964160525462*^9, 
   3.913964160708839*^9}, {3.913964592001299*^9, 3.9139646061290092`*^9}, {
   3.913964734826824*^9, 3.9139647351545343`*^9}, {3.913964890372109*^9, 
   3.913964896619937*^9}, {3.9139650314935427`*^9, 3.91396511098908*^9}, {
   3.913965142070448*^9, 3.913965155436859*^9}, {3.9139653873844757`*^9, 
   3.913965421233624*^9}, 3.913966421128244*^9, {3.914034946754917*^9, 
   3.91403494910736*^9}, {3.9140389945423803`*^9, 3.914039006623897*^9}, {
   3.914059146299593*^9, 3.914059157116803*^9}, {3.914059285038097*^9, 
   3.9140592946780853`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"55971601-838d-43fb-b578-68e722cd0902"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Display the Eigenvalues of the Time Independent Schr\[ODoubleDot]dinger \
Equation\
\>", "Subsection",
 CellChangeTimes->{{3.91396486176626*^9, 3.913964867954948*^9}, 
   3.913964901787156*^9, {3.913965603544465*^9, 
   3.913965612791807*^9}},ExpressionUUID->"7d4a311f-2d73-4de4-a333-\
a093576bbb0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Range", "[", "states", "]"}], "-", "1"}], ",", "eigv"}], 
    "}"}]}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.913964903827847*^9, 3.913964952635749*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"62c0b516-644b-48c6-8bef-8a308d8dbe7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot the Solutions of Time Independent Schr\[ODoubleDot]dinger \
Equation", "Subsection",
 CellChangeTimes->{{3.913963751423419*^9, 3.913963754903453*^9}, {
  3.913965577888277*^9, 
  3.913965600161065*^9}},ExpressionUUID->"4c2229fc-3430-494a-b9e5-\
5e505b986e08"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"V", "[", "x", "]"}], "[", "1", "]"}], ",", 
       RowBox[{"eigf", "+", "eigv"}]}], "}"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"range", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"range", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.913963748575542*^9, 3.913963789688593*^9}, {
  3.913963831824836*^9, 3.913963879451239*^9}, {3.913963936083321*^9, 
  3.913963936210088*^9}, {3.9139639716117496`*^9, 3.913963985058587*^9}, {
  3.913964178821355*^9, 3.913964205485339*^9}, {3.913964570592936*^9, 
  3.913964571690174*^9}, {3.914036823286601*^9, 3.9140368538774347`*^9}, {
  3.9140383893609123`*^9, 3.9140384300718727`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"a52c5d94-13f8-4cae-96c6-707b4c9fdfe2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve the Time Dependent Schr\[ODoubleDot]dinger Equation", "Subsection",
 CellChangeTimes->{{3.9139656322037487`*^9, 
  3.913965638816592*^9}},ExpressionUUID->"966587c4-d47c-44ca-84e1-\
66a3e93e42d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tdsol", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "/.", 
        RowBox[{"First", "@", "#"}]}], "&"}], "/@", 
      RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"I", "*", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], "==", 
           RowBox[{
            RowBox[{"H", "[", "x", "]"}], "[", 
            RowBox[{"\[Psi]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"\[Psi]", "[", 
            RowBox[{"x", ",", "0"}], "]"}], "==", "#"}], ",", 
          RowBox[{"DirichletCondition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Psi]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "==", "0"}], ",", "True"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"range", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"range", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "time"}], "}"}]}], "\[IndentingNewLine]",
        "]"}]}], "&"}], "/@", "eigf"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.914034974060063*^9, 3.9140350535629673`*^9}, {
   3.9140351168428583`*^9, 3.914035230867489*^9}, {3.914035276300549*^9, 
   3.914035337411763*^9}, {3.914035421591381*^9, 3.914035424275525*^9}, {
   3.91403547774398*^9, 3.914035480075794*^9}, 3.9140369166709347`*^9, 
   3.914037020520769*^9, 3.914038154792506*^9, {3.914038562362995*^9, 
   3.914038581165842*^9}, {3.9140390709854717`*^9, 3.9140391793616056`*^9}, 
   3.914039368172186*^9, {3.914059174572105*^9, 3.914059210645206*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"7ccfc829-4744-4a10-b293-4ed083945197"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plot the Solutions of the Time Dependent Schr\[ODoubleDot]dinger Equation\
\>", "Subsection",
 CellChangeTimes->{{3.914038966442934*^9, 
  3.914038976837191*^9}},ExpressionUUID->"28b921ec-37e1-4778-8898-\
a6eda4d0c40a"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Evaluate", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"V", "[", "x", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "t"}], "}"}], ",", 
                 RowBox[{"Re", "@", "#"}]}], "]"}], ",", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "t"}], "}"}], ",", 
                 RowBox[{"Im", "@", "#"}]}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"tdsol", "+", "eigv", "+", 
              RowBox[{"I", "*", "eigv"}]}], ")"}]}], "]"}]}]}], "}"}]}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"range", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"range", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"AxesOrigin", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "time"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.914040449686615*^9, 3.914040485392919*^9}, {
   3.9140405179331284`*^9, 3.9140405429166718`*^9}, 3.914040748578446*^9, {
   3.91404079230165*^9, 3.9140407929018803`*^9}, 3.914040882659523*^9, {
   3.914059230873948*^9, 3.9140592609979067`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"06c1d69b-c0d4-4753-bfa2-044c04e0ee39"]
}, Open  ]]
},
WindowSize->{1440, 758.25},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b94fc6f3-0a04-4f9f-a95c-30e30cd50a48"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 219, 3, 29, "Input",ExpressionUUID->"b7a31ac3-dfcd-4a3c-a585-ea3acb046ac5"],
Cell[CellGroupData[{
Cell[802, 27, 166, 3, 54, "Subsection",ExpressionUUID->"29dc15db-f790-4c39-af0d-7794c4c676cd"],
Cell[971, 32, 1146, 21, 29, "Input",ExpressionUUID->"cad3968a-2de2-40d2-a19d-f98f6857fb46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2154, 58, 235, 4, 54, "Subsection",ExpressionUUID->"ef7b5dcf-5e4a-43b6-aae7-fe2a6a6cbd1c"],
Cell[2392, 64, 1047, 24, 50, "Input",ExpressionUUID->"6eef68dd-c07c-45fc-aa9d-9dca8496f116"],
Cell[3442, 90, 387, 10, 29, "Input",ExpressionUUID->"89b05b43-ad18-498c-9e77-d000ce9c095f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3866, 105, 229, 4, 54, "Subsection",ExpressionUUID->"cb3d4d57-a52a-4465-9fe7-3baaea4fe5df"],
Cell[4098, 111, 2210, 48, 50, "Input",ExpressionUUID->"55971601-838d-43fb-b578-68e722cd0902"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6345, 164, 310, 7, 54, "Subsection",ExpressionUUID->"7d4a311f-2d73-4de4-a333-a093576bbb0f"],
Cell[6658, 173, 357, 9, 29, "Input",ExpressionUUID->"62c0b516-644b-48c6-8bef-8a308d8dbe7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7052, 187, 270, 5, 54, "Subsection",ExpressionUUID->"4c2229fc-3430-494a-b9e5-5e505b986e08"],
Cell[7325, 194, 1013, 23, 29, "Input",ExpressionUUID->"a52c5d94-13f8-4cae-96c6-707b4c9fdfe2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8375, 222, 207, 3, 54, "Subsection",ExpressionUUID->"966587c4-d47c-44ca-84e1-66a3e93e42d9"],
Cell[8585, 227, 2209, 54, 70, "Input",ExpressionUUID->"7ccfc829-4744-4a10-b293-4ed083945197"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10831, 286, 229, 5, 54, "Subsection",ExpressionUUID->"28b921ec-37e1-4778-8898-a6eda4d0c40a"],
Cell[11063, 293, 1971, 51, 70, "Input",ExpressionUUID->"06c1d69b-c0d4-4753-bfa2-044c04e0ee39"]
}, Open  ]]
}
]
*)

